# SutazAI Recommended Firewall Rules
# Apply these rules to secure network access

# Allow SSH (adjust port as needed)
-A INPUT -p tcp --dport 22 -j ACCEPT

# Allow HTTP/HTTPS
-A INPUT -p tcp --dport 80 -j ACCEPT
-A INPUT -p tcp --dport 443 -j ACCEPT

# Allow only specific SutazAI services (examples)
# Main dashboard/API
-A INPUT -p tcp --dport 8000 -s 10.0.0.0/8 -j ACCEPT
-A INPUT -p tcp --dport 8000 -s 172.16.0.0/12 -j ACCEPT
-A INPUT -p tcp --dport 8000 -s 192.168.0.0/16 -j ACCEPT

# Monitoring (Prometheus)
-A INPUT -p tcp --dport 10200 -s 10.0.0.0/8 -j ACCEPT
-A INPUT -p tcp --dport 10200 -s 172.16.0.0/12 -j ACCEPT
-A INPUT -p tcp --dport 10200 -s 192.168.0.0/16 -j ACCEPT

# Block all other external access to SutazAI ports
-A INPUT -p tcp --dport 10000:12000 -j DROP

# Allow loopback
-A INPUT -i lo -j ACCEPT

# Allow established connections
-A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT

# Default drop
-A INPUT -j DROP
