# Resource Optimization Configuration

services:
  # Neo4j - Currently at 96% memory usage
  neo4j:
    environment:
      # Reduce memory allocation
      NEO4J_server_memory_heap_initial__size: 128M
      NEO4J_server_memory_heap_max__size: 256M
      NEO4J_server_memory_pagecache_size: 64M
    deploy:
      resources:
        limits:
          memory: 384M  # Reduced from 512M
          cpus: '0.5'
        reservations:
          memory: 256M

  # Vector databases - Over-provisioned
  chromadb:
    deploy:
      resources:
        limits:
          memory: 512M  # Reduced from 1G
          cpus: '0.5'
        reservations:
          memory: 256M

  qdrant:
    deploy:
      resources:
        limits:
          memory: 512M  # Reduced from 1G
          cpus: '0.5'
        reservations:
          memory: 256M

  faiss:
    deploy:
      resources:
        limits:
          memory: 384M  # Reduced from 768M
          cpus: '0.5'
        reservations:
          memory: 256M

  # Ollama - Way over-provisioned
  ollama:
    deploy:
      resources:
        limits:
          memory: 4G   # Reduced from 23G
          cpus: '2.0'
        reservations:
          memory: 2G
          cpus: '1.0'
