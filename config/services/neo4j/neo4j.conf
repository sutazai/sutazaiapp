# Neo4j Configuration for SutazAI System
# Optimized for low resource consumption (1GB total memory allocation)

# Database settings - Using modern Neo4j 5.x configuration names
initial.dbms.default_database=sutazai
dbms.databases.default_to_read_only=false

# JVM Heap Settings - Reduced for efficiency
server.memory.heap.initial_size=256m
server.memory.heap.max_size=512m

# Page Cache Settings - Optimized for small datasets
server.memory.pagecache.size=256m

# Off-heap memory settings
server.memory.off_heap.max_size=128m

# Network settings - Using modern configuration
server.bolt.enabled=true
server.bolt.listen_address=0.0.0.0:7687
server.http.enabled=true
server.http.listen_address=0.0.0.0:7474

# Connection pool optimization
server.bolt.thread_pool_min_size=5
server.bolt.thread_pool_max_size=20
server.http.max_threads=20

# Security settings
dbms.security.auth_enabled=true

# Transaction and Query Performance
dbms.transaction.timeout=30s
dbms.transaction.concurrent.maximum=100

# Logging - Reduced verbosity
dbms.logs.query.enabled=false
server.logs.user.level=WARN
server.logs.debug.level=WARN

# Checkpoint Performance - More frequent, smaller checkpoints
dbms.checkpoint.interval.time=30s
dbms.checkpoint.interval.tx=10000

# Transaction Log Management - Aggressive cleanup
dbms.tx_log.rotation.retention_policy=100M size
dbms.tx_log.rotation.size=25M

# Memory-mapped I/O settings
server.memory.pagecache.warmup.enable=false
server.memory.pagecache.scan.prefetch=false

# Disable unnecessary features for performance
dbms.cypher.runtime=slotted
dbms.cypher.lenient_create_relationship=false

# Network optimization
server.bolt.connection_keep_alive=1m
server.bolt.connection_keep_alive_streaming_scheduling_interval=1m

# GC Settings for low memory usage
server.jvm.additional=-XX:+UseG1GC
server.jvm.additional=-XX:+UnlockExperimentalVMOptions
server.jvm.additional=-XX:G1HeapRegionSize=4m
server.jvm.additional=-XX:G1ReservePercent=15
server.jvm.additional=-XX:InitiatingHeapOccupancyPercent=75
server.jvm.additional=-XX:+DisableExplicitGC
server.jvm.additional=-XX:+ExitOnOutOfMemoryError