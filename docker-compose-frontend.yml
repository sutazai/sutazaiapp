version: '3.8'

services:
  jarvis-frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
    container_name: sutazai-jarvis-frontend
    hostname: jarvis-frontend
    restart: unless-stopped
    ports:
      - "11000:11000"
    environment:
      # Backend connection
      BACKEND_URL: http://sutazai-backend:10200
      
      # Streamlit settings
      STREAMLIT_SERVER_PORT: 11000
      STREAMLIT_SERVER_ADDRESS: 0.0.0.0
      STREAMLIT_THEME_BASE: dark
      STREAMLIT_THEME_PRIMARY_COLOR: "#00D4FF"
      
      # Voice settings
      WAKE_WORD: jarvis
      SPEECH_RECOGNITION_ENGINE: google
      TTS_ENGINE: pyttsx3
      VOICE_LANGUAGE: en-US
      
      # Features
      ENABLE_VOICE_COMMANDS: "true"
      ENABLE_TYPING_ANIMATION: "true"
      SHOW_SYSTEM_METRICS: "true"
      
      # Logging
      PYTHONUNBUFFERED: 1
      LOG_LEVEL: INFO
    
    volumes:
      - ./frontend:/app
      - jarvis-data:/app/data
      - jarvis-logs:/app/logs
    
    networks:
      sutazai-network:
        ipv4_address: 172.20.0.31
    
    # Backend is in separate compose file, no direct dependency
    
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:11000/_stcore/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 30s
    
    labels:
      - "com.sutazai.service=frontend"
      - "com.sutazai.component=jarvis"
      - "com.sutazai.version=5.0.0"

networks:
  sutazai-network:
    external: true
    name: sutazaiapp_sutazai-network

volumes:
  jarvis-data:
    driver: local
  jarvis-logs:
    driver: local