# Multi-Modal Fusion Configuration for SutazAI Platform
# Optimized for 69 AI agents, high concurrency, and real-time processing

# Temporal synchronization settings
temporal_window: 2.0          # Time window for synchronization (seconds)
sync_tolerance: 0.2           # Acceptable time difference for alignment (seconds)
buffer_size: 1000            # Maximum items in temporal buffers

# Feature representation settings
feature_dim: 768             # Unified feature dimension (matches transformer models)
embedding_model: "nomic-embed-text"  # Primary embedding model via Ollama
secondary_models:
  text: "tinyllama"          # Text processing model per Rule 16
  coding: "tinyllama2.5-coder:3b" # Coding analysis model
  analysis: "tinyllama2.5:3b"     # General analysis model

# Fusion strategy configuration
default_fusion_strategy: "hybrid"
late_fusion_method: "weighted_average"  # Options: weighted_average, voting, max_confidence
early_fusion_projection: "learned"      # Options: learned, pca, linear
enable_attention: true
attention_heads: 8
attention_dropout: 0.1

# Processing configuration
max_workers: 12              # Thread pool size (optimized for 12 CPU cores)
max_processes: 6             # Process pool size for CPU-intensive tasks
batch_size: 32              # Batch processing size
queue_max_size: 1000        # Maximum queue size
processing_timeout: 60       # Processing timeout (seconds)

# Cache configuration
cache_size: 2000             # Fusion result cache size
cache_ttl: 300              # Cache time-to-live (seconds)
enable_cache: true
cache_compression: true

# Integration endpoints (SutazAI infrastructure)
ollama_url: "http://ollama:10104"
ollama_backup_urls:
  - "http://ollama-secondary:11435"
  - "http://ollama-tertiary:11436"

jarvis_url: "http://jarvis:8080"
jarvis_voice_endpoint: "/api/v1/voice/process"
jarvis_tts_endpoint: "/api/v1/tts/synthesize"

chromadb_url: "http://chromadb:8000"
chromadb_collection: "sutazai_multimodal"

qdrant_url: "http://qdrant:6333"
qdrant_collection: "multimodal_embeddings"

neo4j_url: "bolt://neo4j:7687"
neo4j_database: "sutazai"

# Agent orchestration integration
agent_orchestrator_url: "http://backend:8000/api/v1/agents"
agent_registry_path: "/opt/sutazaiapp/agents"
max_agent_parallel: 10       # Maximum parallel agent executions

# Modality-specific settings
modalities:
  text:
    max_length: 8192         # Maximum text length for processing
    chunk_size: 512          # Text chunking size
    overlap: 50             # Chunk overlap
    preprocessing:
      - "lowercase"
      - "strip_whitespace"
      - "remove_special_chars"
    confidence_threshold: 0.7
  
  voice:
    sample_rate: 16000       # Audio sample rate
    max_duration: 30         # Maximum audio duration (seconds)
    feature_extraction: "mfcc"
    n_mfcc: 13              # Number of MFCC coefficients
    preprocessing:
      - "normalize"
      - "noise_reduction"
      - "voice_activity_detection"
    confidence_threshold: 0.6
  
  visual:
    max_resolution: [1024, 1024]  # Maximum image resolution
    color_space: "RGB"
    feature_extraction: "cnn"
    model_backbone: "resnet50"    # Would use actual vision model
    preprocessing:
      - "resize"
      - "normalize"
      - "augmentation"
    confidence_threshold: 0.8
  
  sensor:
    max_samples: 10000       # Maximum time series length
    sampling_window: 1.0     # Sampling window (seconds)
    feature_extraction: "statistical"
    statistical_features:
      - "mean"
      - "std"
      - "min"
      - "max"
      - "median"
      - "percentile_25"
      - "percentile_75"
      - "skewness"
      - "kurtosis"
    preprocessing:
      - "outlier_removal"
      - "smoothing"
      - "normalization"
    confidence_threshold: 0.75

# Performance optimization
optimization:
  enable_gpu: false            # GPU acceleration (set to true if available)
  mixed_precision: false       # Mixed precision training
  gradient_checkpointing: true # Memory optimization
  compile_models: true         # Model compilation for speed
  prefetch_factor: 2          # Data prefetching
  num_workers: 4              # Data loading workers

# Monitoring and logging
monitoring:
  enable_metrics: true
  metrics_port: 9090
  log_level: "INFO"           # DEBUG, INFO, WARNING, ERROR
  log_file: "/opt/sutazaiapp/logs/fusion_system.log"
  performance_tracking: true
  latency_tracking: true
  memory_tracking: true
  queue_monitoring: true
  alert_thresholds:
    processing_latency: 5.0   # Alert if processing > 5 seconds
    queue_size: 500          # Alert if queue > 500 items
    memory_usage: 0.85       # Alert if memory > 85%

# Security settings
security:
  enable_authentication: true
  api_key_required: true
  rate_limiting:
    requests_per_minute: 1000
    burst_size: 100
  input_validation: true
  sanitize_inputs: true
  max_input_size: "100MB"
  allowed_file_types: ["txt", "json", "wav", "mp3", "jpg", "png", "csv"]

# Experimental features
experimental:
  enable_continual_learning: false
  adaptive_fusion_weights: true
  online_model_updates: false
  federated_fusion: false
  quantum_attention: false     # Experimental quantum-inspired attention

# Resource limits (aligned with system specs: 29GB RAM, 12 CPU cores)
resources:
  max_memory_mb: 8192         # 8GB limit for fusion system
  cpu_limit: 8.0              # Use 8 of 12 available cores
  disk_cache_mb: 2048         # 2GB disk cache
  network_timeout: 30         # Network timeout (seconds)
  
# Debugging and development
debug:
  enable_profiling: false
  save_intermediate_results: false
  verbose_logging: false
  dump_failed_inputs: true
  performance_benchmarking: false