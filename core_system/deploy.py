#!/usr/bin/envpython3importloggingimportsubprocessimporttimefromtypingimportList,Tuplefromsetup_directoriesimportcreate_directory_structurefromerror_recoveryimportrollback_deploymentlogging.basicConfig(level=logging.INFO)logger=logging.getLogger(__name__)DEPENDENCIES=["python3.12","postgresql","uvicorn","streamlit"]SERVICES=[("model_server","uvicornbackend.model_server:app--host0.0.0.0--port8001"),("api_server","uvicornbackend.api_routes:app--host0.0.0.0--port8000"),("frontend","streamlitrunfrontend/app.py--server.port8501")]defcheck_dependencies():"""Verifysystemdependencies"""missing=[]fordepinDEPENDENCIES:try:subprocess.run(cmd, shell=False, capture_output=True),stdout=open(f"/opt/SUTAZAI/logs/{name}.log","a"),stderr=subprocess.STDOUT)logger.info(f"Started{name}service")time.sleep(2)#StaggerservicestartsexceptExceptionase:logger.error(f"Failedtostart{name}:{str(e)}")raisedefmain():try:logger.info("Startingdeployment...")check_dependencies()create_directory_structure()deploy_services()logger.info("Deploymentcompletedsuccessfully")exceptExceptionase:logger.critical(f"Deploymentfailed:{str(e)}")rollback_deployment()exit(1)if__name__=="__main__":main()