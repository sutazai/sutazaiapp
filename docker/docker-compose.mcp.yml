services:
  mcp-server:
    build:
      context: ./mcp_server
    image: sutazai-mcp-server:v1.0.0
    container_name: sutazai-mcp-server
    env_file:
    - ./mcp_server/.env
    environment:
    - BACKEND_API_URL=${BACKEND_API_URL:-http://host.docker.internal:8000}
    - OLLAMA_URL=${OLLAMA_URL:-http://host.docker.internal:11434}
    - SEQUENTIAL_THINKING_IMAGE=${SEQUENTIAL_THINKING_IMAGE:-mcp/sequentialthinking}
    - MCP_HTTP_PORT=${MCP_HTTP_PORT:-3030}
    volumes: null
    user: 1000:1000
    ports:
    - 3030:3030
    healthcheck:
      test:
      - CMD-SHELL
      - 'node -e ''process.exit(0)'' '
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 20s
    restart: unless-stopped
    deploy:
      resources:
        limits:
          cpus: '1.0'
          memory: 512M
        reservations:
          cpus: '0.25'
          memory: 128M
  mcp-inspector:
    image: ghcr.io/modelcontextprotocol/inspector:latest
    container_name: mcp-inspector
    ports:
    - 6274:6274
    environment:
    - PORT=6274
    restart: unless-stopped
    deploy:
      resources:
        limits:
          cpus: '1.0'
          memory: 512M
        reservations:
          cpus: '0.25'
          memory: 128M
networks:
  default:
    name: sutazai-mcp
