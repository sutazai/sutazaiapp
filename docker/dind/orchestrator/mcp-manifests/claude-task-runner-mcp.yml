apiVersion: mcp/v1
kind: MCPContainer
metadata:
  name: mcp-claude-task-runner
  labels:
    mcp.service: claude-task-runner
    mcp.tier: execution
spec:
  image: python:3.11-slim
  container_name: mcp-claude-task-runner
  working_dir: /app
  command: ["python", "-m", "task_runner.mcp.server"]
  environment:
    PYTHONUNBUFFERED: "1"
    MCP_PORT: "3003"
    TASK_ISOLATION: "true"
    MESH_ENABLED: "true"
  ports:
    "13004": "3003"
  volumes:
    mcp_shared_data: /mcp-shared
    /opt/sutazaiapp/mcp-servers/claude-task-runner: /app:ro
  healthcheck:
    test: ["CMD", "python", "-c", "import requests; requests.get('http://localhost:3003/health')"]
    interval: 30s
    timeout: 10s
    retries: 3
    start_period: 45s
  restart_policy: unless-stopped
  resources:
    limits:
      cpus: "1.0"
      memory: 512M
    reservations:
      cpus: "0.2"
      memory: 128M
  networks:
    - sutazai-dind-internal
  labels:
    mcp.managed: "true"
    mcp.protocol: "http"
    mcp.integration: "task-execution"
    mcp.service: "true"