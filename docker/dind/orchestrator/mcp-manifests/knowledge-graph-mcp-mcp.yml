apiVersion: mcp/v1
kind: MCPContainer
metadata:
  name: mcp-knowledge-graph-mcp
  labels:
    mcp.service: knowledge-graph-mcp
    mcp.tier: knowledge
spec:
  image: python:3.11-slim
  container_name: mcp-knowledge-graph-mcp
  command:
  - python
  - -m
  - knowledge_graph.server
  - --port
  - '3014'
  environment:
    MCP_PORT: '3014'
    MESH_ENABLED: 'true'
    SERVICE_NAME: knowledge-graph-mcp
    PYTHONUNBUFFERED: '1'
  ports:
    '13014': '3014'
  volumes:
    mcp_shared_data: /mcp-shared
    /opt/sutazaiapp: /opt/sutazaiapp:ro
  healthcheck:
    test:
    - CMD
    - wget
    - -q
    - --spider
    - http://localhost:3014/health
    interval: 30s
    timeout: 10s
    retries: 3
    start_period: 45s
  restart_policy: unless-stopped
  resources:
    limits:
      cpus: '0.5'
      memory: 512M
    reservations:
      cpus: '0.1'
      memory: 64M
  networks:
  - sutazai-dind-internal
  labels:
    mcp.managed: 'true'
    mcp.protocol: http
    mcp.integration: knowledge_graph_mcp
    mcp.service: 'true'
