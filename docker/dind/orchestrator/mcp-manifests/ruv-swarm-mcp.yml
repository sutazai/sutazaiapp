apiVersion: mcp/v1
kind: MCPContainer
metadata:
  name: mcp-ruv-swarm
  labels:
    mcp.service: ruv-swarm
    mcp.tier: orchestration
spec:
  image: node:18-alpine
  container_name: mcp-ruv-swarm
  command: ["npx", "ruv-swarm", "server", "--port", "3002"]
  environment:
    NODE_ENV: production
    MCP_PORT: "3002"
    SWARM_MODE: "mesh"
    MESH_ENABLED: "true"
  ports:
    "13003": "3002"
  volumes:
    mcp_shared_data: /mcp-shared
    /opt/sutazaiapp: /opt/sutazaiapp:ro
  healthcheck:
    test: ["CMD", "wget", "-q", "--spider", "http://localhost:3002/health"]
    interval: 30s
    timeout: 10s
    retries: 3
    start_period: 30s
  restart_policy: unless-stopped
  resources:
    limits:
      cpus: "0.5"
      memory: 256M
    reservations:
      cpus: "0.1"
      memory: 64M
  networks:
    - sutazai-dind-internal
  labels:
    mcp.managed: "true"
    mcp.protocol: "http"
    mcp.integration: "swarm"
    mcp.service: "true"