apiVersion: mcp/v1
kind: MCPContainer
metadata:
  name: mcp-http
  labels:
    mcp.service: http
    mcp.tier: integration
spec:
  image: ghcr.io/modelcontextprotocol/http:latest
  container_name: mcp-http
  environment:
    ALLOWED_HOSTS: "github.com,api.github.com,httpbin.org"
    REQUEST_TIMEOUT: "30"
    MAX_REDIRECTS: "5"
    USER_AGENT: "SutazAI-MCP-HTTP/1.0"
  ports:
    "13003": "3000"  # MCP protocol port
  healthcheck:
    test: ["CMD", "curl", "-f", "http://localhost:3000/health"]
    interval: 30s
    timeout: 10s
    retries: 3
    start_period: 30s
  restart_policy: unless-stopped
  resources:
    limits:
      cpus: "0.5"
      memory: 256M
    reservations:
      cpus: "0.1"
      memory: 64M
  networks:
    - sutazai-dind-internal
    - sutazai-main  # Need external access for HTTP requests
  labels:
    mcp.managed: "true"
    mcp.protocol: "stdio"
    mcp.integration: "http"