FROM postgres:16-alpine
LABEL maintainer="SutazAI Security Team"
LABEL security.hardening="enabled"

# Security hardening
RUN apk --no-cache add su-exec && \
    chmod 750 /var/lib/postgresql && \
    chown postgres:postgres /var/lib/postgresql

# Non-root user setup
USER postgres
EXPOSE 5432
HEALTHCHECK --interval=30s --timeout=10s --start-period=60s --retries=3 \
    CMD curl -f http://localhost:${PORT:-8000}/health || exit 1
# Health check for service availability

