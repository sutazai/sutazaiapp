# SutazAI Security Configuration

# Authentication
auth:
  jwt_secret_key: "${JWT_SECRET_KEY}"  # Set via environment variable
  jwt_algorithm: "HS256"
  access_token_expire_minutes: 60
  refresh_token_expire_days: 7
  password_requirements:
    min_length: 12
    require_uppercase: true
    require_lowercase: true
    require_numbers: true
    require_special_chars: true
    
# Authorization
authorization:
  default_role: "viewer"
  roles:
    admin:
      permissions: ["*"]
      description: "Full system access"
    user:
      permissions: ["read", "write", "execute"]
      description: "Standard user access"
    viewer:
      permissions: ["read"]
      description: "Read-only access"
    agent:
      permissions: ["execute", "read"]
      description: "AI agent access"
      
# Encryption
encryption:
  algorithm: "AES-256-GCM"
  key_rotation_days: 90
  data_at_rest: true
  data_in_transit: true
  
# Rate Limiting
rate_limiting:
  enabled: true
  default_limit: 100  # requests per minute
  window_seconds: 60
  
  endpoints:
    "/api/v1/auth/login": 5
    "/api/v1/brain/think": 10
    "/api/v1/models/generate": 20
    "/api/v1/agents/execute": 30
    
# IP Security
ip_security:
  whitelist_enabled: false
  whitelist:
    - "127.0.0.1"
    - "::1"
    - "10.0.0.0/8"
    - "172.16.0.0/12"
    - "192.168.0.0/16"
    
  blacklist_enabled: true
  auto_block_threshold: 10  # failed attempts
  block_duration_minutes: 60
  
# Session Management
sessions:
  timeout_minutes: 60
  idle_timeout_minutes: 30
  max_concurrent_sessions: 5
  secure_cookie: true
  http_only: true
  same_site: "strict"
  
# Audit Logging
audit:
  enabled: true
  retention_days: 90
  log_file: "/logs/security_audit.log"
  
  events_to_log:
    - login_success
    - login_failed
    - logout
    - password_changed
    - permission_denied
    - rate_limit_exceeded
    - security_scan
    - data_encrypted
    - data_decrypted
    - gdpr_request
    
# Compliance
compliance:
  gdpr:
    enabled: true
    data_retention_days: 365
    right_to_erasure: true
    data_portability: true
    consent_required: true
    
  hipaa:
    enabled: false
    encryption_required: true
    audit_trail_required: true
    
  soc2:
    enabled: true
    security_controls: true
    availability_monitoring: true
    
# Security Headers
security_headers:
  X-Content-Type-Options: "nosniff"
  X-Frame-Options: "DENY"
  X-XSS-Protection: "1; mode=block"
  Strict-Transport-Security: "max-age=31536000; includeSubDomains; preload"
  Content-Security-Policy: "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self'; connect-src 'self' ws: wss:; frame-ancestors 'none';"
  Referrer-Policy: "strict-origin-when-cross-origin"
  Permissions-Policy: "geolocation=(), microphone=(), camera=(), payment=(), usb=(), magnetometer=(), accelerometer=(), gyroscope=()"
  
# Input Validation
validation:
  max_input_length: 10000
  max_file_size_mb: 10
  allowed_file_types:
    - "image/jpeg"
    - "image/png"
    - "image/gif"
    - "application/pdf"
    - "text/plain"
    - "application/json"
    
  sanitize_html: true
  prevent_sql_injection: true
  prevent_xss: true
  prevent_xxe: true
  
# API Security
api_security:
  require_api_key: false
  api_key_header: "X-API-Key"
  cors_enabled: true
  cors_origins:
    - "http://localhost:3000"
    - "http://localhost:8501"
    - "https://sutazai.ai"
    
# Secrets Management
secrets:
  provider: "vault"  # vault, aws_secrets_manager, azure_keyvault
  rotation_enabled: true
  rotation_days: 30
  
# Vulnerability Management
vulnerability:
  scanning_enabled: true
  scan_frequency: "daily"
  dependency_check: true
  container_scanning: true
  
# Incident Response
incident_response:
  enabled: true
  notification_channels:
    - email
    - slack
    - pagerduty
    
  severity_levels:
    critical:
      response_time_minutes: 15
      auto_block: true
      notify_immediately: true
      
    high:
      response_time_minutes: 60
      auto_block: false
      notify_immediately: true
      
    medium:
      response_time_minutes: 240
      auto_block: false
      notify_immediately: false
      
    low:
      response_time_minutes: 1440
      auto_block: false
      notify_immediately: false
      
# Two-Factor Authentication
two_factor:
  enabled: false
  methods:
    - totp
    - sms
    - email
    
  required_for_roles:
    - admin
    
# Password Policy
password_policy:
  enforce_history: 5
  max_age_days: 90
  min_age_days: 1
  lockout_threshold: 5
  lockout_duration_minutes: 30
  complexity_requirements:
    min_unique_chars: 8
    no_common_passwords: true
    no_username_similarity: true
    
# Data Loss Prevention
dlp:
  enabled: true
  sensitive_data_patterns:
    - name: "credit_card"
      pattern: '\b\d{4}[\s-]?\d{4}[\s-]?\d{4}[\s-]?\d{4}\b'
      action: "block"
      
    - name: "ssn"
      pattern: '\b\d{3}-\d{2}-\d{4}\b'
      action: "redact"
      
    - name: "email"
      pattern: '\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b'
      action: "log"
      
# Network Security
network:
  tls_version: "1.3"
  cipher_suites:
    - "TLS_AES_256_GCM_SHA384"
    - "TLS_CHACHA20_POLY1305_SHA256"
    - "TLS_AES_128_GCM_SHA256"
    
  certificate_validation: true
  mutual_tls: false
  
# Container Security
container:
  run_as_non_root: true
  read_only_filesystem: true
  no_new_privileges: true
  security_scanning: true
  
# Monitoring
monitoring:
  security_metrics: true
  alert_on_anomalies: true
  log_analysis: true
  behavior_analytics: true