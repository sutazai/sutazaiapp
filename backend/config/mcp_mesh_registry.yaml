# MCP-Mesh Integration Registry
# Configuration for all MCP servers integrated with the service mesh
# Last Updated: 2025-08-16

mcp_services:
  # Database and Storage Services
  # postgres removed - service failed and causing instability
      
  # File System Services
  - name: files
    service_name: mcp-files
    instances: 2
    port_range: [11103, 11104]
    health_check: /health
    tags: ["mcp", "filesystem", "io"]
    load_balancer: ROUND_ROBIN
    circuit_breaker:
      failure_threshold: 3
      recovery_timeout: 5
    metadata:
      version: "1.0.0"
      capabilities: ["read", "write", "watch", "list"]
      
  # Language and Code Services
  - name: language-server
    service_name: mcp-language-server
    instances: 3
    port_range: [11105, 11107]
    health_check: /health
    tags: ["mcp", "language", "code-analysis", "lsp"]
    load_balancer: IP_HASH  # Sticky sessions for code context
    circuit_breaker:
      failure_threshold: 5
      recovery_timeout: 5
    metadata:
      version: "1.0.0"
      capabilities: ["completion", "diagnostics", "hover", "definition"]
      
  - name: ultimatecoder
    service_name: mcp-ultimatecoder
    instances: 2
    port_range: [11108, 11109]
    health_check: /health
    tags: ["mcp", "codegen", "ai", "refactoring"]
    load_balancer: WEIGHTED
    circuit_breaker:
      failure_threshold: 5
      recovery_timeout: 5
    metadata:
      version: "1.0.0"
      capabilities: ["generate", "refactor", "optimize", "test"]
      
  - name: sequentialthinking
    service_name: mcp-sequentialthinking
    instances: 2
    port_range: [11110, 11111]
    health_check: /health
    tags: ["mcp", "reasoning", "ai", "planning"]
    load_balancer: ROUND_ROBIN
    circuit_breaker:
      failure_threshold: 5
      recovery_timeout: 5
    metadata:
      version: "1.0.0"
      capabilities: ["analyze", "plan", "reason", "solve"]
      
  - name: context7
    service_name: mcp-context7
    instances: 2
    port_range: [11112, 11113]
    health_check: /health
    tags: ["mcp", "context", "library", "documentation"]
    load_balancer: RANDOM
    circuit_breaker:
      failure_threshold: 3
      recovery_timeout: 5
    metadata:
      version: "1.0.0"
      capabilities: ["docs", "examples", "references"]
      
  # Web and Network Services
  - name: ddg
    service_name: mcp-ddg
    instances: 2
    port_range: [11116, 11117]
    health_check: /health
    tags: ["mcp", "search", "web", "duckduckgo"]
    load_balancer: ROUND_ROBIN
    circuit_breaker:
      failure_threshold: 3
      recovery_timeout: 5
    metadata:
      version: "1.0.0"
      capabilities: ["search", "suggestions", "instant_answers"]
      
  # Memory and Persistence Services
  - name: extended-memory
    service_name: mcp-extended-memory
    instances: 1  # Single instance for consistency
    port_range: [11118, 11118]
    health_check: /health
    tags: ["mcp", "memory", "persistence", "state"]
    load_balancer: ROUND_ROBIN  # Single instance, doesn't matter
    circuit_breaker:
      failure_threshold: 5
      recovery_timeout: 5
    metadata:
      version: "1.0.0"
      capabilities: ["store", "retrieve", "search", "expire"]
      
  - name: memory-bank-mcp
    service_name: mcp-memory-bank
    instances: 1  # Single instance for consistency
    port_range: [11119, 11119]
    health_check: /health
    tags: ["mcp", "memory", "bank", "cache"]
    load_balancer: ROUND_ROBIN
    circuit_breaker:
      failure_threshold: 5
      recovery_timeout: 5
    metadata:
      version: "1.0.0"
      capabilities: ["store", "query", "index", "delete"]
      
  # Remote Access Services
  - name: mcp_ssh
    service_name: mcp-ssh
    instances: 2
    port_range: [11120, 11121]
    health_check: /health
    tags: ["mcp", "ssh", "remote", "exec"]
    load_balancer: LEAST_CONNECTIONS
    circuit_breaker:
      failure_threshold: 3
      recovery_timeout: 5
    metadata:
      version: "1.0.0"
      capabilities: ["exec", "transfer", "tunnel", "shell"]
      
  # Development Tools
  - name: nx-mcp
    service_name: mcp-nx
    instances: 1
    port_range: [11122, 11122]
    health_check: /health
    tags: ["mcp", "nx", "monorepo", "workspace"]
    load_balancer: ROUND_ROBIN
    circuit_breaker:
      failure_threshold: 3
      recovery_timeout: 5
    metadata:
      version: "1.0.0"
      capabilities: ["workspace", "generators", "executors", "graph"]
      
  # Browser Automation Services
  - name: playwright-mcp
    service_name: mcp-playwright
    instances: 2
    port_range: [11125, 11126]
    health_check: /health
    tags: ["mcp", "browser", "testing", "playwright"]
    load_balancer: LEAST_CONNECTIONS
    circuit_breaker:
      failure_threshold: 3
      recovery_timeout: 5
    metadata:
      version: "1.0.0"
      capabilities: ["test", "automate", "record", "trace"]
      
  # Knowledge and Discovery Services
  - name: knowledge-graph-mcp
    service_name: mcp-knowledge-graph
    instances: 1
    port_range: [11127, 11127]
    health_check: /health
    tags: ["mcp", "graph", "knowledge", "reasoning"]
    load_balancer: ROUND_ROBIN
    circuit_breaker:
      failure_threshold: 5
      recovery_timeout: 5
    metadata:
      version: "1.0.0"
      capabilities: ["graph", "query", "reason", "infer"]
      
  - name: compass-mcp
    service_name: mcp-compass
    instances: 1
    port_range: [11128, 11128]
    health_check: /health
    tags: ["mcp", "discovery", "recommendation", "navigation"]
    load_balancer: ROUND_ROBIN
    circuit_breaker:
      failure_threshold: 3
      recovery_timeout: 5
    metadata:
      version: "1.0.0"
      capabilities: ["discover", "recommend", "navigate", "suggest"]

# Global MCP configuration
global_config:
  default_timeout: 5.0
  default_retry_count: 3
  health_check_interval: 10
  startup_delay: 2  # Seconds between starting instances
  max_instances_per_server: 10
  port_allocation_strategy: sequential  # or random
  enable_metrics: true
  enable_tracing: true
  enable_logging: true