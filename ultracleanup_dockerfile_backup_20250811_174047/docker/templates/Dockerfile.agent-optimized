# ULTRA OPTIMIZED Agent Dockerfile Template
# Replaces 300+ individual agent Dockerfiles
# Usage: Copy this template and customize only the ENV variables

FROM sutazai-python-agent-master-fixed:latest

# Agent-specific metadata (CUSTOMIZE THESE)
ENV AGENT_ID="{AGENT_ID}"
ENV AGENT_TYPE="{AGENT_TYPE}" 
ENV AGENT_NAME="{AGENT_NAME}"
ENV SERVICE_PORT=8080

# Install agent-specific requirements (OPTIONAL)
# COPY requirements.txt /tmp/agent-requirements.txt
# RUN pip install --no-cache-dir -r /tmp/agent-requirements.txt && rm /tmp/agent-requirements.txt

# Copy agent code
COPY . /app/

# Expose port
EXPOSE $SERVICE_PORT

# Health check using base image utility
HEALTHCHECK --interval=30s --timeout=10s --start-period=60s --retries=3 \
    CMD curl -f http://localhost:$SERVICE_PORT/health || exit 1

# Use optimized base agent if app.py doesn't exist
CMD ["python", "-c", "import os; exec(open(os.path.join('agents', 'core', 'example_optimized_agent.py')).read()) if not os.path.exists('app.py') else exec(open('app.py').read())"]